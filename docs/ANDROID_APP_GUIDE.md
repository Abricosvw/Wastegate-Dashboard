# ECU Dashboard Android App - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéØ –û–±–∑–æ—Ä

Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏–µ–º–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è CAN –¥–∞–Ω–Ω—ã—Ö –æ—Ç ESP32 ECU Dashboard —á–µ—Ä–µ–∑ WiFi –∏–ª–∏ Bluetooth —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úì **WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ WebSocket
- ‚úì **Bluetooth –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- ‚úì **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (10Hz)
- ‚úì **6 –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞—Ç—á–∏–∫–æ–≤** –∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–∞—à–±–æ—Ä–¥–µ
- ‚úì **PWA –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚úì **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∏ –ø–ª–∞–Ω—à–µ—Ç–æ–≤

---

## üì± –°–ø–æ—Å–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: Native Android App (–ì–û–¢–û–í–û!)

**–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ:**
- ‚úì Kotlin + Jetpack Compose UI
- ‚úì WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket
- ‚úì 6 –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞—Ç—á–∏–∫–æ–≤
- ‚úì Material 3 Design
- ‚úì –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –¥–µ–º–æ —Ä–µ–∂–∏–º

**–ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `ECU_Dashboard_Android/` –≤ Android Studio
2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ Gradle —Ñ–∞–π–ª—ã
3. –°–æ–±–µ—Ä–∏—Ç–µ APK: `Build ‚Üí Build Bundle(s) / APK(s) ‚Üí Build APK(s)`
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ APK –Ω–∞ Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### –í–∞—Ä–∏–∞–Ω—Ç 2: Web App (–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

**–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ WiFi —Å–µ—Ç–∏ ESP32:
   - SSID: `ECU_Dashboard`
   - Password: `12345678`

2. –û—Ç–∫—Ä–æ–π—Ç–µ Chrome –Ω–∞ Android:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞: `http://192.168.4.1/mobile`

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - –ù–∞–∂–º–∏—Ç–µ –º–µ–Ω—é (‚ãÆ) ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESP32 –¥–ª—è WebSocket

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ main.c:

```c
#include "can_websocket.h"

void app_main(void)
{
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ...
    
    // –ó–∞–ø—É—Å–∫ WiFi AP
    wifi_init_softap();
    
    // –ó–∞–ø—É—Å–∫ WebSocket —Å–µ—Ä–≤–µ—Ä–∞
    start_websocket_server();
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ broadcast
    xTaskCreate(websocket_broadcast_task, "WS_BROADCAST", 4096, NULL, 5, NULL);
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
}

// –í CAN –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –¥–æ–±–∞–≤–∏—Ç—å:
void can_receive_task(void *pvParameters)
{
    // ... –ø–æ–ª—É—á–µ–Ω–∏–µ CAN –¥–∞–Ω–Ω—ã—Ö ...
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ WebSocket –¥–∞–Ω–Ω—ã—Ö
    update_websocket_can_data(
        engine_rpm, 
        map_pressure, 
        tps_position,
        wastegate_pos,
        target_boost,
        tcu_status
    );
}
```

### WiFi –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```c
void wifi_init_softap(void)
{
    wifi_config_t wifi_config = {
        .ap = {
            .ssid = "ECU_Dashboard",
            .ssid_len = strlen("ECU_Dashboard"),
            .channel = 1,
            .password = "12345678",
            .max_connection = 4,
            .authmode = WIFI_AUTH_WPA_WPA2_PSK
        },
    };
    
    ESP_ERROR_CHECK(esp_wifi_set_config(WIFI_IF_AP, &wifi_config));
    ESP_LOGI(TAG, "WiFi AP started. SSID:%s password:%s", 
             "ECU_Dashboard", "12345678");
}
```

---

## üìä –ü—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

### WebSocket JSON —Ñ–æ—Ä–º–∞—Ç:

```json
{
  "map_pressure": 125,      // 100-250 kPa
  "wastegate_pos": 45,      // 0-100 %
  "tps_position": 30,       // 0-100 %
  "engine_rpm": 3500,       // 0-7000 RPM
  "target_boost": 180,      // 100-250 kPa
  "tcu_status": 0           // 0=OK, 1=WARN, 2=ERROR
}
```

### –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- **WebSocket broadcast:** 10Hz (–∫–∞–∂–¥—ã–µ 100ms)
- **UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 60fps —Å –ø–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π
- **CAN polling:** –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ

---

## üé® –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –î–∞—Ç—á–∏–∫–∏:
1. **MAP Pressure** (–°–∏–Ω–∏–π #00D4FF)
   - –î–∏–∞–ø–∞–∑–æ–Ω: 100-250 kPa
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: >200 kPa
   - –û–ø–∞—Å–Ω–æ—Å—Ç—å: >230 kPa

2. **Wastegate** (–ó–µ–ª–µ–Ω—ã–π #00FF88)
   - –î–∏–∞–ø–∞–∑–æ–Ω: 0-100%
   - –ü–æ–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç—É–∞—Ç–æ—Ä–∞

3. **TPS** (–ñ–µ–ª—Ç—ã–π #FFD700)
   - –î–∏–∞–ø–∞–∑–æ–Ω: 0-100%
   - –ü–æ–ª–æ–∂–µ–Ω–∏–µ –¥—Ä–æ—Å—Å–µ–ª—å–Ω–æ–π –∑–∞—Å–ª–æ–Ω–∫–∏

4. **Engine RPM** (–û—Ä–∞–Ω–∂–µ–≤—ã–π #FF6B35)
   - –î–∏–∞–ø–∞–∑–æ–Ω: 0-7000 RPM
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: >5500 RPM
   - –û–ø–∞—Å–Ω–æ—Å—Ç—å: >6500 RPM

5. **Target Boost** (–ñ–µ–ª—Ç—ã–π #FFD700)
   - –î–∏–∞–ø–∞–∑–æ–Ω: 100-250 kPa
   - –¶–µ–ª–µ–≤–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–¥–¥—É–≤–∞

6. **TCU Status** (LED –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)
   - –ó–µ–ª–µ–Ω—ã–π: OK
   - –ñ–µ–ª—Ç—ã–π: WARNING
   - –ö—Ä–∞—Å–Ω—ã–π (–º–∏–≥–∞–µ—Ç): ERROR

---

## üîå Bluetooth –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

```javascript
// Bluetooth Web API –¥–ª—è Chrome Android
navigator.bluetooth.requestDevice({
  filters: [{ name: 'ECU_Dashboard' }],
  optionalServices: ['12345678-1234-5678-1234-56789abcdef0']
})
.then(device => device.gatt.connect())
.then(server => server.getPrimaryService('12345678-1234-5678-1234-56789abcdef0'))
.then(service => service.getCharacteristic('87654321-4321-8765-4321-ba9876543210'))
.then(characteristic => {
  characteristic.addEventListener('characteristicvaluechanged', handleData);
  return characteristic.startNotifications();
});
```

---

## üìã –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

### ESP32 —Å—Ç–æ—Ä–æ–Ω–∞:
```
‚òê WiFi AP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚òê WebSocket —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 81
‚òê CAN –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
‚òê JSON —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

### Android —Å—Ç–æ—Ä–æ–Ω–∞:
```
‚òê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WiFi ESP32
‚òê –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚òê –í—Å–µ 6 –¥–∞—Ç—á–∏–∫–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
‚òê –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–ª–∞–≤–Ω–æ
‚òê TCU —Å—Ç–∞—Ç—É—Å –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
```

---

## üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ SD –∫–∞—Ä—Ç—É
2. **–ì—Ä–∞—Ñ–∏–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏** –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–µ–≤–æ–≥** –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
4. **OBD-II** –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–¥—ã
5. **–ì–æ–ª–æ—Å–æ–≤—ã–µ** –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
6. **GPS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è —Ç—Ä–µ–∫–æ–≤

### –ù–∞—Ç–∏–≤–Ω–æ–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- Kotlin + Jetpack Compose UI
- Room database –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
- WorkManager –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
- Firebase –¥–ª—è –æ–±–ª–∞—á–Ω–æ–≥–æ backup

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### WebSocket –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
curl -i -N -H "Connection: Upgrade" -H "Upgrade: websocket" \
     -H "Sec-WebSocket-Version: 13" \
     -H "Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==" \
     http://192.168.4.1:81/ws

# Chrome DevTools
# Console: new WebSocket('ws://192.168.4.1:81/ws')
```

### ESP32 –ª–æ–≥–∏:
```
I (12345) CAN_WEBSOCKET: Starting WebSocket server on port: '81'
I (12346) CAN_WEBSOCKET: WebSocket server started
I (12500) CAN_WEBSOCKET: Handshake done, new WebSocket connection opened
I (12600) CAN_WEBSOCKET: Broadcasting CAN data to 1 clients
```

---

**–§–∞–π–ª:** ANDROID_APP_GUIDE.md  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 26 –∏—é–ª—è 2025  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** ESP32-S3, Android 5.0+, Chrome 89+